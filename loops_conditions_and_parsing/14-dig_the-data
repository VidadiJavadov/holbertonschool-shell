#!/usr/bin/env bash
#apache

LOG_FILE="apache-access.log"

if [ ! -f "$LOG_FILE" ]; then
  echo "Error: Apache log file '$LOG_FILE' not found."
  echo "Please download and place 'apache-access.log' in the same directory as this script."
  exit 1
fi

awk '{ count[$1 " " $9]++ }
END {
    # Instead of 'for (pair in count)', we print each element
    # and then rely on sort to handle the ordering and final display.
    # This might print pairs in an arbitrary order initially
    # but the subsequent 'sort' command will fix it.
    for (pair in count) { # Awk's internal 'for' loop is still needed to iterate through associative arrays
        print count[pair], pair
    }
}' "$LOG_FILE" | sort -rn
